<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HK School Interview Practice - School Information</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* 主布局样式 */
        .content-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* 两栏布局 */
        .two-column-layout {
            display: flex;
            gap: 30px;
            margin-top: 20px;
        }
        
        /* 左侧栏 - 学校信息 */
        .left-column {
            flex: 1;
            min-width: 0;
        }
        
        .left-column.collapsed {
            display: none;
        }
        
        .school-info-toggle {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            transition: all 0.3s ease;
        }
        
        .school-info-toggle:hover {
            background: linear-gradient(135deg, #2980b9, #1c6ea4);
            transform: translateY(-2px);
        }
        
        /* 右侧栏 - 面试题目 */
        .right-column {
            flex: 1;
            min-width: 0;
        }
        
        @media (max-width: 992px) {
            .two-column-layout {
                flex-direction: column;
            }
            
            .left-column, .right-column {
                width: 100%;
            }
        }
        
        /* 学校卡片样式 */
        .school-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .school-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            border-top: 4px solid #3498db;
        }
        
        .school-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
        }
        
        .school-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .school-card-header h3 {
            font-size: 1.2rem;
            color: #2c3e50;
            margin: 0;
            flex: 1;
        }
        
        .banding-badge {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
            white-space: nowrap;
        }
        
        .banding-1a {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        
        .banding-1b {
            background: linear-gradient(135deg, #e67e22, #d35400);
        }
        
        .banding-1c {
            background: linear-gradient(135deg, #f1c40f, #f39c12);
            color: #333;
        }
        
        .school-card-body {
            margin-bottom: 15px;
        }
        
        .school-card-body p {
            margin-bottom: 8px;
            font-size: 0.95rem;
            line-height: 1.4;
        }
        
        .view-details-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            width: 100%;
            transition: background 0.3s;
        }
        
        .view-details-btn:hover {
            background: linear-gradient(135deg, #2980b9, #1c6ea4);
        }
        
        /* 学校详情样式 */
        .school-detail-card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }
        
        .school-detail-header {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }
        
        .school-detail-header h2 {
            color: #2c3e50;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .school-detail-header h3 {
            color: #3498db;
            margin-bottom: 15px;
        }
        
        .school-motto {
            font-style: italic;
            color: #7f8c8d;
            margin: 10px 0;
            padding-left: 20px;
            border-left: 3px solid #3498db;
        }
        
        .chinese-motto {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .school-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }
        
        .info-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        
        .info-section {
            margin: 25px 0;
            padding-bottom: 25px;
            border-bottom: 1px solid #eee;
        }
        
        .info-section:last-child {
            border-bottom: none;
        }
        
        .info-section h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* 面试题目样式 */
        .interview-questions-card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            height: 100%;
            position: sticky;
            top: 20px;
        }
        
        .interview-header {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .interview-header h2 {
            color: #2c3e50;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .question-toggle {
            background: #ecf0f1;
            color: #2c3e50;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        
        .question-toggle:hover {
            background: #d5dbdb;
        }
        
        .interview-year-section {
            margin-bottom: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #9b59b6;
        }
        
        .interview-year-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }
        
        .interview-year-header h5 {
            color: #2c3e50;
            font-size: 1.1rem;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .interview-months {
            background: #9b59b6;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.85rem;
        }
        
        .question-category {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .question-category h6 {
            color: #2c3e50;
            margin-bottom: 12px;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .question-list {
            padding-left: 20px;
        }
        
        .question-list li {
            margin-bottom: 10px;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 3px solid #2ecc71;
            position: relative;
            padding-left: 15px;
        }
        
        .question-list li::before {
            content: "•";
            color: #2ecc71;
            font-weight: bold;
            position: absolute;
            left: 5px;
        }
        
        .no-questions {
            text-align: center;
            padding: 30px;
            color: #7f8c8d;
            background: white;
            border-radius: 8px;
            border: 2px dashed #ddd;
        }
        
        /* 面试倒计时 */
        .interview-countdown {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
        }
        
        .interview-countdown h5 {
            margin: 0 0 10px 0;
            font-size: 1rem;
        }
        
        .countdown-days {
            font-size: 2rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .countdown-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .interview-date-display {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 12px;
            border-radius: 6px;
            display: inline-block;
        }
        
        /* 面试百分比信息 */
        .interview-percentage-info {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
        }
        
        .interview-percentage-info h5 {
            margin: 0 0 10px 0;
            font-size: 1rem;
        }
        
        .percentage-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .percentage-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .chinese-weight-info {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
        }
        
        .chinese-weight-info h5 {
            margin: 0 0 10px 0;
            font-size: 1rem;
        }
        
        .chinese-weight-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .chinese-weight-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        /* 过滤器和返回按钮 */
        .filters {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .filter-group {
            flex: 1;
            min-width: 200px;
        }
        
        .filter-group label {
            display: block;
            margin-bottom: 8px;
            color: #2c3e50;
            font-weight: 600;
        }
        
        .filter-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            background: white;
            font-size: 1rem;
            color: #2c3e50;
            transition: border-color 0.3s;
        }
        
        .filter-group select:focus {
            border-color: #3498db;
            outline: none;
        }
        
        .back-btn {
            background: #7f8c8d;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 20px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .back-btn:hover {
            background: #6c7b7d;
        }
        
        /* 错误消息 */
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #f5c6cb;
            margin: 20px 0;
        }
        
        /* 无结果消息 */
        .no-results {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
            grid-column: 1 / -1;
        }
        
        .no-results i {
            font-size: 3rem;
            margin-bottom: 20px;
        }
        
        /* 加载动画 */
        .loading-spinner {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Sidebar Navigation -->
    <nav class="sidebar">
        <div class="sidebar-header">
            <h3><i class="fas fa-graduation-cap"></i> HK Interview</h3>
            <button class="toggle-btn" id="sidebar-toggle">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        <div class="sidebar-menu">
            <ul>
                <li>
                    <a href="index.html">
                        <i class="fas fa-home"></i>
                        <span>Home</span>
                    </a>
                </li>
                <li>
                    <a href="subpage_school.html" class="active">
                        <i class="fas fa-school"></i>
                        <span>School Information</span>
                    </a>
                </li>
                <li>
                    <a href="subpage_fwskills_chi.html">
                        <i class="fas fa-star"></i>
                        <span>FW Skills 必備技巧</span>
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="main-header">
            <h1 class="page-title">
                <i class="fas fa-school"></i> 學校資訊及面試題目
            </h1>
            <p class="page-subtitle">香港中學面試準備 - 學校資料庫及歷年面試題目</p>
        </div>
        
        <div class="content-container">
            <!-- 学校列表视图 -->
            <div class="card" id="school-list-view">
                <h2><i class="fas fa-university"></i> 香港中學資訊資料庫</h2>
                <p>本頁面提供香港頂尖中學的詳細資料及歷年面試題目，協助學生準備入學面試。</p>
                
                <!-- 筛选器 -->
                <div class="filters">
                    <div class="filter-group">
                        <label for="banding-filter">按組別篩選:</label>
                        <select id="banding-filter" onchange="filterSchools()">
                            <option value="">所有組別</option>
                            <option value="1A">Band 1A</option>
                            <option value="1B">Band 1B</option>
                            <option value="1C">Band 1C</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="district-filter">按地區篩選:</label>
                        <select id="district-filter" onchange="filterSchools()">
                            <option value="">所有地區</option>
                            <!-- 地区选项将由JavaScript动态生成 -->
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="type-filter">按學校類型篩選:</label>
                        <select id="type-filter" onchange="filterSchools()">
                            <option value="">所有類型</option>
                            <option value="直資">直資學校</option>
                            <option value="資助">資助學校</option>
                        </select>
                    </div>
                </div>
                
                <!-- 学校列表 -->
                <div id="school-list" class="school-grid">
                    <!-- 学校卡片将由JavaScript加载 -->
                    <div class="loading-spinner" id="loading-spinner">
                        <div class="spinner"></div>
                    </div>
                </div>
                
                <!-- 无结果消息 -->
                <div id="no-schools-message" class="no-results" style="display: none;">
                    <i class="fas fa-search"></i>
                    <h3>沒有找到符合條件的學校</h3>
                    <p>請嘗試調整篩選條件</p>
                </div>
            </div>
            
            <!-- 学校详情视图 -->
            <div class="card" id="school-detail-view" style="display: none;">
                <button class="back-btn" onclick="showSchoolList()">
                    <i class="fas fa-arrow-left"></i> 返回學校列表
                </button>
                
                <div class="two-column-layout">
                    <!-- 左侧栏 - 学校信息 -->
                    <div class="left-column" id="school-info-column">
                        <button class="school-info-toggle" id="toggle-school-info">
                            <i class="fas fa-eye-slash"></i> 隱藏學校資訊
                        </button>
                        
                        <div class="school-detail-card" id="school-info-content">
                            <!-- 学校信息内容将由JavaScript加载 -->
                        </div>
                    </div>
                    
                    <!-- 右侧栏 - 面试题目 -->
                    <div class="right-column">
                        <div class="interview-questions-card" id="interview-questions-content">
                            <!-- 面试题目内容将由JavaScript加载 -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        let schoolsData = [];
        let filteredSchools = [];
        let currentSchool = null;
        
        // 学校JSON文件列表
        const schoolFiles = [
            'schools/school_hong_kong_federation_of_youth_groups_lee_shau_kee_college.json',
            'schools/school_lee_kau_pat_memorial_college.json',
            'schools/school_ying_wa_college.json',
            'schools/school_st_pauls_co_educational_college.json',
            'schools/school_po_leung_kuk_tang_yuk_tien_college.json',
            'schools/school_christian_alliance_s_c_chan_memorial_college.json',
            'schools/school_hkbu_affiliated_school_wong_kam_fai_secondary_and_primary_school.json'
        ];
        
        // 加载学校数据
        async function loadSchoolsData() {
            try {
                schoolsData = [];
                
                // 显示加载动画
                const loadingSpinner = document.getElementById('loading-spinner');
                loadingSpinner.style.display = 'flex';
                
                // 并行加载所有学校文件
                const promises = schoolFiles.map(file => 
                    fetch(file)
                        .then(response => {
                            if (!response.ok) {
                                throw new Error(`HTTP错误! 状态码: ${response.status} for ${file}`);
                            }
                            return response.json();
                        })
                        .catch(error => {
                            console.error(`加载学校文件 ${file} 时出错:`, error);
                            return null;
                        })
                );
                
                const loadedSchools = await Promise.all(promises);
                
                // 隐藏加载动画
                loadingSpinner.style.display = 'none';
                
                // 过滤掉加载失败的数据
                schoolsData = loadedSchools.filter(school => school !== null);
                
                if (schoolsData.length === 0) {
                    throw new Error('没有成功加载任何学校数据');
                }
                
                filteredSchools = [...schoolsData];
                
                // 按ID排序学校
                schoolsData.sort((a, b) => a.id - b.id);
                filteredSchools.sort((a, b) => a.id - b.id);
                
                // 初始化筛选器选项
                initializeFilters();
                
                // 显示学校列表
                displaySchoolList();
            } catch (error) {
                console.error('加载学校数据时出错:', error);
                document.getElementById('loading-spinner').style.display = 'none';
                document.getElementById('school-list').innerHTML = 
                    '<div class="error-message">無法加載學校資訊，請檢查網絡連接或文件路徑。</div>';
            }
        }
        
        // 初始化筛选器选项
        function initializeFilters() {
            const districtFilter = document.getElementById('district-filter');
            const districts = new Set();
            
            schoolsData.forEach(school => {
                if (school.district) {
                    districts.add(school.district);
                }
            });
            
            // 按字母顺序排序地区
            const sortedDistricts = Array.from(districts).sort();
            
            // 清空现有选项
            districtFilter.innerHTML = '<option value="">所有地區</option>';
            
            sortedDistricts.forEach(district => {
                const option = document.createElement('option');
                option.value = district;
                option.textContent = district;
                districtFilter.appendChild(option);
            });
        }
        
        // 筛选学校
        function filterSchools() {
            const bandingFilter = document.getElementById('banding-filter').value;
            const districtFilter = document.getElementById('district-filter').value;
            const typeFilter = document.getElementById('type-filter').value;
            
            filteredSchools = schoolsData.filter(school => {
                let matches = true;
                
                if (bandingFilter && school.banding && !school.banding.includes(bandingFilter)) {
                    matches = false;
                }
                
                if (districtFilter && school.district && school.district !== districtFilter) {
                    matches = false;
                }
                
                if (typeFilter && school.type && !school.type.includes(typeFilter)) {
                    matches = false;
                }
                
                return matches;
            });
            
            displaySchoolList();
        }
        
        // 显示学校列表
        function displaySchoolList() {
            const schoolList = document.getElementById('school-list');
            const noSchoolsMessage = document.getElementById('no-schools-message');
            
            schoolList.innerHTML = '';
            
            if (filteredSchools.length === 0) {
                noSchoolsMessage.style.display = 'block';
                schoolList.style.display = 'none';
                return;
            }
            
            noSchoolsMessage.style.display = 'none';
            schoolList.style.display = 'grid';
            
            filteredSchools.forEach(school => {
                const schoolCard = document.createElement('div');
                schoolCard.className = 'school-card';
                schoolCard.innerHTML = `
                    <div class="school-card-header">
                        <h3>${escapeHtml(school.name)}</h3>
                        ${school.banding ? `<span class="banding-badge ${getBandingClass(school.banding)}">${escapeHtml(school.banding)}</span>` : ''}
                    </div>
                    <div class="school-card-body">
                        ${school.chineseName ? `<p><strong>中文名稱:</strong> ${escapeHtml(school.chineseName)}</p>` : ''}
                        ${school.type ? `<p><strong>學校類型:</strong> ${escapeHtml(school.type)}</p>` : ''}
                        ${school.district ? `<p><strong>地區:</strong> ${escapeHtml(school.district)}</p>` : ''}
                        ${school.language ? `<p><strong>教學語言:</strong> ${escapeHtml(school.language)}</p>` : ''}
                        ${school.mission ? `<p><strong>辦學宗旨:</strong> ${escapeHtml(truncateText(school.mission, 50))}</p>` : ''}
                        ${school.interviewPercentage ? `
                            <div class="interview-percentage-info" style="margin: 15px 0; padding: 10px; border-radius: 6px; background: linear-gradient(135deg, #9b59b6, #8e44ad); color: white; text-align: center;">
                                <h5 style="margin: 0 0 5px 0; font-size: 0.9rem;">面試比重</h5>
                                <div style="font-size: 1.2rem; font-weight: bold; margin: 5px 0;">${getInterviewPercentageValue(school.interviewPercentage)}</div>
                            </div>
                        ` : ''}
                        ${school.targetInterviewDate ? `
                            <div class="interview-countdown" style="margin: 15px 0; padding: 10px; border-radius: 6px; background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; text-align: center;">
                                <h5 style="margin: 0 0 5px 0; font-size: 0.9rem;">面試倒計時</h5>
                                <div style="font-size: 0.9rem; margin-bottom: 5px;">${formatDateChinese(school.targetInterviewDate)}</div>
                                <div style="font-size: 1.5rem; font-weight: bold; margin: 5px 0;">${calculateDaysRemaining(school.targetInterviewDate)}</div>
                                <div style="font-size: 0.8rem; opacity: 0.8;">天數</div>
                            </div>
                        ` : ''}
                    </div>
                    <button class="view-details-btn" onclick="viewSchoolDetails(${school.id})">
                        <i class="fas fa-eye"></i> 查看詳情及面試題目
                    </button>
                `;
                schoolList.appendChild(schoolCard);
            });
        }
        
        // 查看学校详情
        function viewSchoolDetails(schoolId) {
            currentSchool = schoolsData.find(s => s.id === schoolId);
            if (!currentSchool) return;
            
            document.getElementById('school-list-view').style.display = 'none';
            document.getElementById('school-detail-view').style.display = 'block';
            
            // 加载学校信息
            loadSchoolInfo();
            
            // 加载面试题目
            loadInterviewQuestions();
        }
        
        // 加载学校信息
        function loadSchoolInfo() {
            const schoolInfoContent = document.getElementById('school-info-content');
            
            let infoHTML = `
                <div class="school-detail-header">
                    <h2>${escapeHtml(currentSchool.name)} ${currentSchool.banding ? `<span class="banding-badge ${getBandingClass(currentSchool.banding)}">${escapeHtml(currentSchool.banding)}</span>` : ''}</h2>
                    ${currentSchool.chineseName ? `<h3>${escapeHtml(currentSchool.chineseName)}</h3>` : ''}
                    ${currentSchool.schoolMotto ? `<p class="school-motto"><i class="fas fa-quote-left"></i> ${escapeHtml(currentSchool.schoolMotto)} <i class="fas fa-quote-right"></i></p>` : ''}
                    ${currentSchool.chineseMotto ? `<p class="chinese-motto">${escapeHtml(currentSchool.chineseMotto)}</p>` : ''}
                </div>
                
                <div class="school-info-grid">
                    ${currentSchool.type ? `<div class="info-item"><strong>學校類型:</strong> ${escapeHtml(currentSchool.type)}</div>` : ''}
                    ${currentSchool.religion ? `<div class="info-item"><strong>宗教背景:</strong> ${escapeHtml(currentSchool.religion)}</div>` : ''}
                    ${currentSchool.gender ? `<div class="info-item"><strong>性別:</strong> ${escapeHtml(currentSchool.gender)}</div>` : ''}
                    ${currentSchool.district ? `<div class="info-item"><strong>地區:</strong> ${escapeHtml(currentSchool.district)}</div>` : ''}
                    ${currentSchool.language ? `<div class="info-item"><strong>教學語言:</strong> ${escapeHtml(currentSchool.language)}</div>` : ''}
                    ${currentSchool.established ? `<div class="info-item"><strong>創校年份:</strong> ${escapeHtml(currentSchool.established)}</div>` : ''}
                </div>
            `;
            
            if (currentSchool.mission) {
                infoHTML += `
                    <div class="info-section">
                        <h4><i class="fas fa-bullseye"></i> 辦學宗旨 (Mission)</h4>
                        <p>${escapeHtml(currentSchool.mission)}</p>
                    </div>
                `;
            }
            
            if (currentSchool.interviewFeatures) {
                infoHTML += `
                    <div class="info-section">
                        <h4><i class="fas fa-comments"></i> 面試特色 (Interview Features)</h4>
                        <p>${escapeHtml(currentSchool.interviewFeatures)}</p>
                    </div>
                `;
            }
            
            if (currentSchool.interviewPercentage) {
                infoHTML += `
                    <div class="info-section">
                        <h4><i class="fas fa-chart-pie"></i> 收生評分比重 (Admission Scoring Weight)</h4>
                        <div class="interview-percentage-info">
                            <h5>面試比重</h5>
                            <div class="percentage-value">${getInterviewPercentageValue(currentSchool.interviewPercentage)}</div>
                            <div class="percentage-label">${escapeHtml(getInterviewPercentageLabel(currentSchool.interviewPercentage))}</div>
                        </div>
                    </div>
                `;
            }
            
            if (currentSchool.specialty) {
                infoHTML += `
                    <div class="info-section">
                        <h4><i class="fas fa-star"></i> 學校特色 (Specialties)</h4>
                        <p>${escapeHtml(currentSchool.specialty)}</p>
                    </div>
                `;
            }
            
            if (currentSchool.specificFeatures) {
                infoHTML += `
                    <div class="info-section">
                        <h4><i class="fas fa-info-circle"></i> 特別設施/計劃 (Specific Features)</h4>
                        <p>${escapeHtml(currentSchool.specificFeatures)}</p>
                    </div>
                `;
            }
            
            infoHTML += `
                <div class="info-section">
                    <h4><i class="fas fa-info-circle"></i> 學校詳細資料 (School Details)</h4>
                    ${currentSchool.studentCount !== undefined ? `<p><strong>學生人數:</strong> ${escapeHtml(currentSchool.studentCount)}</p>` : ''}
                    ${currentSchool.admissionProcess ? `<p><strong>收生程序:</strong> ${escapeHtml(currentSchool.admissionProcess)}</p>` : ''}
                    ${currentSchool.tuitionFee ? `<p><strong>學費:</strong> ${escapeHtml(currentSchool.tuitionFee)}</p>` : ''}
                    ${currentSchool.image ? `<p><strong>學校標誌:</strong> ${escapeHtml(currentSchool.image)}</p>` : ''}
                </div>
            `;
            
            if (currentSchool.targetInterviewDate) {
                infoHTML += `
                    <div class="info-section">
                        <h4><i class="fas fa-calendar-alt"></i> 目標面試日期 (Target Interview Date)</h4>
                        <p><strong>日期:</strong> ${formatDateChinese(currentSchool.targetInterviewDate)}</p>
                        <div class="interview-countdown">
                            <h5>面試倒計時</h5>
                            <div class="interview-date-display">${formatDateChinese(currentSchool.targetInterviewDate)}</div>
                            <div class="countdown-days">${calculateDaysRemaining(currentSchool.targetInterviewDate)}</div>
                            <div class="countdown-label">天數</div>
                        </div>
                    </div>
                `;
            }
            
            if (currentSchool.website || currentSchool.phone) {
                infoHTML += `
                    <div class="info-section">
                        <h4><i class="fas fa-globe"></i> 聯絡資料 (Contact Information)</h4>
                        ${currentSchool.phone ? `<p><strong>電話:</strong> ${escapeHtml(currentSchool.phone)}</p>` : ''}
                        ${currentSchool.website ? `<p><strong>網址:</strong> <a href="${escapeHtml(currentSchool.website)}" target="_blank">${escapeHtml(currentSchool.website)}</a></p>` : ''}
                    </div>
                `;
            }
            
            schoolInfoContent.innerHTML = infoHTML;
        }
        
        // 加载面试题目
        function loadInterviewQuestions() {
            const questionsContent = document.getElementById('interview-questions-content');
            
            // 生成面试题目HTML
            let interviewQuestionsHTML = '';
            
            if (currentSchool.previousInterviewQuestions && Object.keys(currentSchool.previousInterviewQuestions).length > 0) {
                interviewQuestionsHTML = generateInterviewQuestionsHTML(currentSchool.previousInterviewQuestions);
            } else {
                interviewQuestionsHTML = `
                    <div class="interview-header">
                        <h2><i class="fas fa-history"></i> 歷年面試題目</h2>
                    </div>
                    <div class="no-questions">
                        <i class="fas fa-file-alt" style="font-size: 3rem; margin-bottom: 20px; color: #bdc3c7;"></i>
                        <h4>暫無面試題目資料</h4>
                        <p>目前尚未收集到此學校的歷年面試題目</p>
                    </div>
                `;
            }
            
            questionsContent.innerHTML = interviewQuestionsHTML;
            
            // 添加题目分类切换功能
            addQuestionToggleFunctionality();
        }
        
        // 生成面试题目HTML
        function generateInterviewQuestionsHTML(questionsData) {
            let html = `
                <div class="interview-header">
                    <h2><i class="fas fa-history"></i> 歷年面試題目</h2>
                </div>
            `;
            
            // 添加中文面試比重分析
            const chineseQuestionsCount = countChineseQuestions(questionsData);
            const totalQuestionsCount = countTotalQuestions(questionsData);
            
            if (totalQuestionsCount > 0) {
                const chinesePercentage = Math.round((chineseQuestionsCount / totalQuestionsCount) * 100);
                html += `
                    <div class="chinese-weight-info" style="margin-bottom: 20px;">
                        <h5>中文面試題目比重分析</h5>
                        <div class="chinese-weight-value">${chinesePercentage}%</div>
                        <div class="chinese-weight-label">中文題目佔歷年面試題目總數</div>
                        <p style="font-size: 0.8rem; margin-top: 8px; opacity: 0.8;">(${chineseQuestionsCount}題中文 / ${totalQuestionsCount}題總數)</p>
                    </div>
                `;
            }
            
            // 按年份排序（从最新到最旧）
            const years = Object.keys(questionsData).sort((a, b) => b - a);
            
            for (const year of years) {
                const data = questionsData[year];
                html += `
                    <div class="interview-year-section">
                        <div class="interview-year-header">
                            <h5><i class="fas fa-calendar"></i> ${year} 年度面試題目</h5>
                            ${data.months ? `<span class="interview-months">${data.months.join(', ')}月</span>` : ''}
                        </div>
                `;
                
                if (data.questions && Object.keys(data.questions).length > 0) {
                    // 按分类名称排序
                    const categories = Object.keys(data.questions).sort();
                    for (const category of categories) {
                        const questions = data.questions[category];
                        const isChineseCategory = category.includes('中文') || category.includes('普通話');
                        html += `
                            <div class="question-category" data-category="${escapeHtml(category)}">
                                <h6><i class="fas fa-question-circle"></i> ${escapeHtml(category)} ${isChineseCategory ? '<span style="color: #27ae60; font-size: 0.8rem;">(中文)</span>' : ''}</h6>
                                <ul class="question-list">
                                    ${questions.map(question => `<li>${escapeHtml(question)}</li>`).join('')}
                                </ul>
                            </div>
                        `;
                    }
                } else {
                    html += `<p class="no-questions">此年度暫無面試題目資料</p>`;
                }
                
                html += `</div>`;
            }
            
            return html;
        }
        
        // 添加题目分类切换功能
        function addQuestionToggleFunctionality() {
            const questionCategories = document.querySelectorAll('.question-category');
            
            // 创建题目分类列表
            if (questionCategories.length > 0) {
                const categories = Array.from(questionCategories).map(cat => cat.getAttribute('data-category'));
                const uniqueCategories = [...new Set(categories)];
                
                let toggleHTML = '<div style="margin-bottom: 20px; display: flex; flex-wrap: wrap; gap: 10px;">';
                uniqueCategories.forEach(category => {
                    toggleHTML += `
                        <button class="question-toggle" onclick="toggleQuestionCategory('${escapeHtml(category)}')">
                            ${escapeHtml(category)}
                        </button>
                    `;
                });
                toggleHTML += '</div>';
                
                // 将切换按钮添加到面试题目区域的顶部
                const interviewHeader = document.querySelector('.interview-header');
                interviewHeader.insertAdjacentHTML('afterend', toggleHTML);
            }
        }
        
        // 切换题目分类显示
        function toggleQuestionCategory(category) {
            const categoryElements = document.querySelectorAll(`.question-category[data-category="${escapeHtml(category)}"]`);
            categoryElements.forEach(element => {
                element.style.display = element.style.display === 'none' ? 'block' : 'none';
            });
        }
        
        // 显示学校列表
        function showSchoolList() {
            document.getElementById('school-list-view').style.display = 'block';
            document.getElementById('school-detail-view').style.display = 'none';
        }
        
        // 切换学校信息显示/隐藏
        function toggleSchoolInfo() {
            const schoolInfoColumn = document.getElementById('school-info-column');
            const toggleButton = document.getElementById('toggle-school-info');
            
            if (schoolInfoColumn.classList.contains('collapsed')) {
                // 显示学校信息
                schoolInfoColumn.classList.remove('collapsed');
                toggleButton.innerHTML = '<i class="fas fa-eye-slash"></i> 隱藏學校資訊';
            } else {
                // 隐藏学校信息
                schoolInfoColumn.classList.add('collapsed');
                toggleButton.innerHTML = '<i class="fas fa-eye"></i> 顯示學校資訊';
            }
        }
        
        // 辅助函数
        function getBandingClass(banding) {
            if (!banding) return 'banding-1c';
            if (banding.includes('1A')) return 'banding-1a';
            if (banding.includes('1B')) return 'banding-1b';
            if (banding.includes('1C')) return 'banding-1c';
            return 'banding-1c';
        }
        
        // 获取面试百分比值
        function getInterviewPercentageValue(percentageString) {
            if (!percentageString) return 'N/A';
            const match = percentageString.match(/面試\s*:\s*(\d+)%/);
            return match ? `${match[1]}%` : 'N/A';
        }
        
        // 获取面试百分比标签
        function getInterviewPercentageLabel(percentageString) {
            if (!percentageString) return '';
            return percentageString.replace('面試:', '面試: ').replace(';', '; ');
        }
        
        // 统计中文题目数量
        function countChineseQuestions(questionsData) {
            let count = 0;
            for (const [year, data] of Object.entries(questionsData)) {
                if (data.questions) {
                    for (const [category, questions] of Object.entries(data.questions)) {
                        if (category.includes('中文') || category.includes('普通話')) {
                            count += questions.length;
                        }
                    }
                }
            }
            return count;
        }
        
        // 统计总题目数量
        function countTotalQuestions(questionsData) {
            let count = 0;
            for (const [year, data] of Object.entries(questionsData)) {
                if (data.questions) {
                    for (const [category, questions] of Object.entries(data.questions)) {
                        count += questions.length;
                    }
                }
            }
            return count;
        }
        
        // 格式化为YYYY年MM月DD日 (星期W)
        function formatDateChinese(dateString) {
            try {
                const date = new Date(dateString);
                if (isNaN(date.getTime())) {
                    return dateString; // 如果日期无效，返回原始字符串
                }
                
                const year = date.getFullYear();
                const month = (date.getMonth() + 1).toString().padStart(2, '0');
                const day = date.getDate().toString().padStart(2, '0');
                
                // 星期几的映射
                const weekdays = ['日', '一', '二', '三', '四', '五', '六'];
                const weekday = weekdays[date.getDay()];
                
                return `${year}年${month}月${day}日 (星期${weekday})`;
            } catch (error) {
                console.error('日期格式化错误:', error);
                return dateString;
            }
        }
        
        function calculateDaysRemaining(targetDateStr) {
            try {
                const targetDate = new Date(targetDateStr);
                const today = new Date();
                
                if (isNaN(targetDate.getTime())) {
                    return '日期无效';
                }
                
                today.setHours(0, 0, 0, 0);
                targetDate.setHours(0, 0, 0, 0);
                
                const diffTime = targetDate - today;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                if (diffDays > 0) return diffDays;
                if (diffDays === 0) return '0 (今天)';
                return '已過期';
            } catch (error) {
                console.error('计算天数错误:', error);
                return '日期错误';
            }
        }
        
        function truncateText(text, maxLength) {
            if (!text) return '';
            if (text.length <= maxLength) return text;
            return text.substring(0, maxLength) + '...';
        }
        
        // HTML转义函数
        function escapeHtml(text) {
            if (!text) return '';
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.toString().replace(/[&<>"']/g, function(m) { return map[m]; });
        }
        
        // 页面加载完成后执行
        document.addEventListener('DOMContentLoaded', function() {
            // 加载学校数据
            loadSchoolsData();
            
            // 侧边栏切换
            const sidebarToggle = document.getElementById('sidebar-toggle');
            if (sidebarToggle) {
                sidebarToggle.addEventListener('click', function() {
                    document.querySelector('.sidebar').classList.toggle('collapsed');
                });
            }
            
            // 学校信息显示/隐藏切换
            const toggleSchoolInfoBtn = document.getElementById('toggle-school-info');
            if (toggleSchoolInfoBtn) {
                toggleSchoolInfoBtn.addEventListener('click', toggleSchoolInfo);
            }
        });
    </script>
</body>
</html>